Quest: PRA1002b
DisplayName: Rage of the Ratcatcher
-- Message panels
QRC:

QuestorOffer:  [1000]

RefuseQuest:   [1001]

AcceptQuest:  [1002]

QuestFail:  [1003]

QuestComplete:  [1004]

RumorsDuringQuest:  [1005]

--Logs
Message:  1050
%qdt:
I have received a letter from _questgiver_, the self-styled
Ratcatcher General. It's barely legible, but it seems %g
wants me to meet %g2 at _tav_ in __tav_
to discuss a 'special task'.

Message:  1051
%qdt:
I found _questgiver_ in _tav_ worse for wear.
There was a small altercation and I've had to take him
to his rooms to sleep it off. I should go by in the morning
and see if he's making any more sense then.

Message: 1052
%qdt:
_questgiver_ can't do anything until his bar tab has
been paid at _tav_. He owes _bartab_ gold.
I may have to pay it for him.

Message:  1053
%qdt:
I've helped _questgiver_ settle his bartab. Now we can get down
to business.

Message: 1054
%qdt:
_questgiver_ thinks the rats are behaving strangely.
He wants us to catch one of the horde and take it to
_mages_ in __mages_ where they will perform some tests.

-- Dialogues
Message:  1100
<ce>A messenger approaches and hands you a letter.

Message:  1101
<ce>This badly written letter is from The Ratcatcher General,
<ce>looks like he is at _tav_ in __tav_ and needs your help
<ce>again.

Message:  1102
As you enter a voice rings out, "There %pg is!
%pcf! My old buddy-in-arms!"
<ce>
It's _questgiver_, the self-styled Ratcacher General.
And %g is obviously very, very drunk.
<ce>
"%pcf! Over here! Wait til you lads see what %pg can do!"
"%pcf! Destroy that table!"

Message:  1103
"Sit down _questgiver_, before you fall down!" yells
the barman.
<ce>
"You a friend of %g3? Fool's been drinking for days.
Making a right mess here %g has. You're here now.
Deal with %g2."

Message:  1104
The Ratchacher spins on %g3 heel and points %g3 finger
at the place the barman would have been if the barman
had been somewhere else entirely.
<ce>
"You don't... never speak to %pcf like that! Never!
%pcf is my comrade! We slew many beasts together..."

Message:  1105
A shabby man sitting near the door responds,
"You killed many rats, mate. My dog does that
and he's got a gammy leg and can't see."

Message:  1106
"You know nothing of our quarry %mn! Nothing!"
yells the Ratcatcher in general direction of the man.
"Come on! Come with us now! See what we face!
You'll fill your old britches quick enough!"

Message:  1107
The barman addresses you again with more urgency,
"Seriously %ra, shut %g2 up or get %g2 out."

Message:  1108
"C'mon.... All of you. I'll show you the horrors
that skulk in your homes when you slumber.
Eating the fingers of babes."
<ce>
<ce>Make %g2 shut up?

Message:  1109
You put your hand on %g3 shoulder and %g1 spins around,
loses %g3 balance and lands on the floor, tries to get
up, fails miserably, then goes to sleep like a crumpled
up corpse.

Message:  1110
The barman claps his hands together, "Right. Well that's
%g2 shut up. Get %g2 to %g3 room %ra. When %g1 wakes up
in the morning, get %g2 the hells out. You can have
%g3 gear once %g3 tab is paid ...and it's not pretty."

Message:  1111
"Rats are smarter than you think. Smarter than all of
you!"
<ce>
The barman booms at you, "%ra!"

Message:  1112
A large man sitting at a table nearby slams down his
tankard and stands up, "You're not smarter than my
fist Ratmuncher!"
<ce>
He takes a swing at the Ratcatcher who accidentally
sways out of the way and the fist hits you instead.

Message:  1113
The fight over you look around to see where the
_questgiver_ is and find %g2 passed out in the corner.
You would think %g2 dead if it wasn't for %g2 snoring
like an elderly bear

Message:  1114
You should probably take %g2 to %g3 rooms to sleep it off.

Message:  1115
_questgiver_ weighs more than %g looks.

Message:  1116
You dump _questgiver_ in %g3 room on the bed.
In %g3 sleep %g mumbles something a king, farts and
rolls over.
<ce>
Best give %g2 time to sleep it off.

Message:  1117
I should maybe check on _questgiver_.

Message:  1118
"Oh, hello %pcf. You got my letter then? Good.
I was wondering when you would show up. I was almost
getting my things ready to leave."

Message:  1162
"Slight problem there though. My... host, a lovely man
here called _barkeep_ took my gear while I was...
indesposed and won't return it until I settle up with
him. Sad fact is, I don't have that kind of gold right
now.
<ce>
Perhaps you could have a word with him for me?
Maybe talk him round? Oh, speak of the demon..."

Message: 1120
"I suppose you've come for _questgiver_'s gear?
As I told you last night, he gets it back when he's
settled the tab. Which is 150g."
<ce>
<ce>Try to talk the barman down?

Message: 1121
"No doing. He caused damage during his stay. Both to the
furniture and my tavern's reputation. Do you think
everyone wants to hear the ins and outs of killing rats
every night? I'd almost swear he was planted here by the
competition."
<ce>
"He gets his rat killing stuff back when I get 150g
in my hand. Either from him or from you."
<ce>
<ce>Pay his tab?

Message: 1122
"Look. I've nothing against the guy. I feel sorry for
him, really. No-one cares for rat-catchers, but it's a
necessary job. I want him out of here as much as you do.
I've got a business to run."
<ce>
"Tell you what, I'll take 75g. Call it even."
<ce>
<ce>Pay the reduced tab?

Message: 1123
Look. I want him out, he's caused chaos since he's been here.
If he's not offending the customers with stories about killin'
rats, he's depressing them with stories about how his killin'
rats drove away his missus..."
<ce>
"Tell you what. Do a little favour for me and I'll wipe the tab
and let you have his gear? It's nothing dangerous or illegal,
really. Deal?"

Message:  1165
Are you ready to pay up?

Message:  1163
Ok. Here's what I need you to do. I've got some clothes here.
I want you to take them to _othertav_ and leave them in one
of the back rooms. Simple. Like I said. No risk. Then you
get _questgiver_'s gear.

Message:  1164
Ok. Ok. So there's a bit of skullduggery here. Clothes
belong to a lady I... know. When her husband finds them
there, and he will, he's going to think the proprieor
is doing his missus. He'll be livid with him.

Message:  1159
<ce>You don't have enough gold.

Message:  1160
Right. Here's his stuff. He's not welcome back here again.

Message: 1124
"Ok, well I tried to be reasonable. I need that tab covered
IN FULL within the week, or I sell his gear to recoup my losses.
It won't, but it'll get rid of the smell."
<ce>
"Oh, and he's not to come back here again."

Message:  1161
Well, _barkeep_ will have sold or dumped my stuff by now.
That's me out of the game.
Been nice knowing you _questgiver_ but I'm off to live
under a bridge.

Message: 1125
I can't do ratcatching without my gear %pcf. Can't even
make the money without being able to catch rats.
No idea how I can get that within a week.

Message: 1126
I'll make it up to you %pcf, I promise.
Anyway, I got a job for us. Hamlet, major issue with
these vindictive rats. Going to need to try something
different this time. Going to need to take one of these
buggers alive. Got a mage friend who owes me for clearing
his guild a while ago. He's going to cast some magicks
on the thing and see what evil is driving it.
Some evil is driving these things now. I swear.

Message: 1127
Same as before. You take the bait, draw the rats,
I'm going to try to grab one and bag it. Might take
a few attempts because they don't like going in the bag.

Message: 1128
OK. Got one. Festy bugger. I'll take back the bait, you
take the ratbag.

Message: 1129
Dammit. He got out.

Message: 1130
Let's try that again.

Message: 1131
_questgiver_! Look here everyone. The great Ratchatcher General is back!

Message: 1132
Ok, yeah. I rememeber. I said I'd help you look into this rat plague as a favour for helping us with our rat problem.
Do you see where I'm going with this? Maybe the scrabbling in the walls or the incesant squeaking might help.

Message: 1133
Ok %pcf, looks like things are getting worse. We need to clear this place again. I don't know why they are here again. I cleared this place weeks ago. I swear. They usually don't return this quickly.

Message: 1134
Well, thanks _questgiver_. You've dealt with our rat problem. Again. Howe can we ever repay you... etc.
Where's the live one we needed?

Message: 1135
This place was swarming with the buggers. Why did you need me to bring one when you could have just picked one up off the floor.

Message: 1136
We're mages, _questgiver_, not Ratcatchers. Wouldn't want to step on your toes and have the full weight of the Ratcatchers Guild ontop of us.

Message: 1137
Ok, enough smarm. Here's your bagged rat. See if you can find out what magics is riving these things.

Message: 1138
have you ever thought that maybe they've just set up a rival guild. Maybe you should speak to The Rat King?

Message: 1139
Shut up about The Rat King. There's no such thing as a rat king.

Message: 1140
Just because you haven't seen one doesn't mean they don't exist.

Message: 1141
Just do your magicks on the rat and let me know what you find. It won't be no rat king. Probably something one of you lot did messing about with things that your noses don't belong in.

Message: 1142
Don't have time for that _questgiver_, with all the jobs the likes of you dump on us then somehow manage to blame us for.

Message: 1143
Two attacks in... what? A month? I know I brag but once I clear a house it stays cleared, usually for years. I killed all your rats. These ones... they came after. Like they was wanting something.

Message: 1144
I'm as curious as you Ratcatcher. You may be barely human and smell like a latrine, but you are good at what you do. Give me a week.

Message: 1145
%pcf! Ratcatcher! Quickly come to _mages_. They've been attacked again.

Message: 1146
Quickly %pcf, to the _mages_. This is not normal.

Message: 1147
They came out of no-where. Ran amok. Then they found your specimen and killed it. It was like an assassination.

Message: 1148
Damn! Please tell me you were able to run tests on it before...

Message: 1149
Yes. Thouroughly and more during the attack. These rats are not magically enhanced. They are just normal, smelly, vicious, diseased giant rats that are somehow gathering in warlike tribes.

Message: 1150
Enough sarcasm. What did you find?!

Message: 1151
No sarcasm Ratcatcher. Furthermore these rat attacks seem to be following you. Haven't you noticed? They go where you are. Or where you are heading. If yhere were rat attacks on this scale all over the province we'd know about it. You are drawing the rats Ratcatcher. You and your friend. I know not why, but I would quite appreciate if you got out of our town and didn't return.

Message: 1152
What? This is not my doing! I kill rats...

Message: 1153
and they hate you for it. Ever think that maybe you've just killed so many of them that those that remain have decided to deal with you to save themselves?
Regardless. This is your problem. And yours only. Please leave. Take your friend and your foul accoutrements and don't darken our guild or town again.

Message: 1154
%pcf... I think I need to stop and think. I do my best thinking in the tavern. Lets go to the tavern.

Message: 1155
Ratcatcher!

Message: 1156
Yeah, we know your game. Bet he's carrying them in a bag and releasing them then comes round thinking he can just waltz in and 'save' us. Get out.

Message: 1157
Ratcatcher! I think it might be for the best if you and your friend left town. Don't you? For your own good you understand. People aren't too happy with you right now. Can't blame them.

Message: 1158
I didn't... %pcf? You know me. I wouldn't. Ratcatching is my life. I wouldn't bsmirch the name of my craft. You must belive me!

Message:  1119
_questgiver_ is still snoring. Occasionally he whimpers
and cries out for someone called _wife_.
<ce>
Probably best give him another few hours.

Message: 1201
Hi %pcf,
<ce>
tis me righting you the ratcatcher genral you might 
remeeber we done a clean of the properties here in
___questgiver_ i am sure you are busy with your things
and all but I could use your assistance been working few
towns lately and it as been heavy work much heavyer than
usual i know i know iam no youngster but something is not
right about the rats we done in behaviour has been off they
semm more aggresive and almost targetted i do not belive in
no rat king nonsense, but I have been in this game long
enough to recognise when things just are not right.
<ce>
sos i culd use your help again if you can meet me at
_tav_ got a special task for us
<ce>
do not be late they have happy hour

Message:  1202
Dad,
<ce>
Mum showed me the letter you wrote her. Just don't.
She's got a new life now. Away from the filth that
follows you. Leave her alone. Leave me alone.
You'll never change. We know that now. We gave you
all the chances we could.
<ce>
I've told her to burn any further letters she receives
with your awful tell-tale writing on them. Neither me
nor her want you in our lives anymore. Leave us alone!
<ce>
Goodbye dad. I love you, but I never want to see or
hear from you again.
<ce>
                                Your daughter,
                                    _daughter_
QBN:
Item _letter_ letter used 1201
Item _letter2_ letter used 1202
Item rcsleep dead_body
Item _bartab_ gold range 100 to 200
Item _smalltab_ gold range 50 to 100
Item _bait_ small_sack
Item _evidence_ womens_clothing

Clock _delivery_ 00:01
Clock _awake_ 08:00 12:00
Clock _check_ 3:00
Clock _destitute_ 7.00:00

Foe _thug_ is Barbarian
Foe _rats_ is 2 Giant_rat

Person _questgiver_ group Questor male
Person _barkeep_ group Innkeeper male
Person _daughter_ group Resident1 female
Person _wife_ group Resident2 female

Place _tav_ local tavern
Place _othertav_ local tavern
Place _mages_ local magery

variable _attav_
variable _sleeper_
variable _check_
variable _overdue_

--	Quest start-up:
	start timer _delivery_
    pc at _tav_ set _attav_
    _letter_ used do _letterread_
    have rcsleep set _sleeper_

_merc_ task:
    when skill Mercantile is at least 25

_smart_ task:
    when attribute Intelligence is at least 60

_delivery_ task:
    get item _letter_ saying 1100
    place npc _questgiver_ at _tav_
    place npc _barkeep_ at _tav_
    place item _letter2_ at _tav_
    hide npc _barkeep_

_letterread_ task:
    say 1101
    log 1050 0

_qgclicked_ task:
    clicked npc _questgiver_

_drunk_ task:
    player within 4 units of item _letter2_
    say 1102
    say 1103
    say 1104
    say 1105
    say 1106
    say 1107
    prompt 1108 yes _sleep_ no _fight_

_sleep_ task:
    say 1109

_over_ task:
    when _thugdone_ or _sleep_
    hide npc _questgiver_
    place item rcsleep at _tav_
    say 1110
    say 1114

_fight_ task:
    say 1111
    say 1112
    create foe _thug_ every 0 minutes 1 times with 100% success

_thugdone_ task:
    killed _thug_
    say 1113

_tobed_ task:
    when _sleeper_
    add _questgiver_ face
    say 1115

_inbed_ task:
    dropped rcsleep at _tav_ saying 1116
    drop _questgiver_ face
    log 1051 1
    start timer _awake_
    start timer _check_

_notcorpse_ task:
    player within 2 units of item rcsleep

_notawake_ task:
    when _inbed_ and _check_ and _notcorpse_ and not _awake_
    say 1119

_awake_ task:
    say 1117
    restore npc _questgiver_

_thetask_ task:
    when _qgclicked_ and _awake_
    say 1118
    hide npc _questgiver_
    add _questgiver_ face
    say 1162
    restore npc _barkeep_
    log 1052 2

_clickedbarkeep_ task:
    clicked npc _barkeep_

_settling_ task:
    when _clickedbarkeep_
    prompt 1120 yes _haggle_ no _favour_

_haggle_ task:

_reduced_ task:
    when _haggle_ and _merc_
    prompt 1122 yes _payred_ no _favour_

_nodice_ task:
    when _haggle_ and not _merc_
    prompt 1121 yes _paytab_ no _nodeal_

_paytab_ task:
    take _bartab_ from pc
    start task _stuff_

_payred_ task:
    take _smalltab_ from pc
    start task _stuff_

_favour_ task:
    prompt 1123 yes _deal_ no _nodeal_

_deal_ task:
    say 1163
    get item _evidence_

_moreinfo_ task:
    when _deal_ and _smart_
    say 1164

_toopoor_ task:
    say 1159
    start task _nodeal_

_nodeal_ task:
    say 1124
    say 1125
    clear _clickedbarkeep_
    setvar _overdue_
    start timer _destitute_

_destitute_ task:
    say 1161
    drop _questgiver_ face
    end quest

_payfull_ task:
    when _clickedbarkeep_ and _overdue_
    prompt 1165 yes _payup_ no _notpay_

_payup_ task:
    take _bartab_ from pc    
    start task _stuff_

_notpay_ task:
    clear _clickedbarkeep_

_stuff_ task:
    get item _bait_ saying 1160
    stop timer _destitute_
    log 1053 3
    hide npc _barkeep_